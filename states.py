# =============================================
# states.py ‚Äî –í–°–ï FSM-–°–û–°–¢–û–Ø–ù–ò–Ø –ë–û–¢–ê
# =============================================
"""
–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è Finite State Machine (FSM) –±–æ—Ç–∞.

–ü–æ—á–µ–º—É FSM:
- aiogram 3.x –∏—Å–ø–æ–ª—å–∑—É–µ—Ç FSM –¥–ª—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
- –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è:
  1. –û–∂–∏–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø–æ—Å–ª–µ –∫–Ω–æ–ø–∫–∏ ¬´–ù–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ¬ª
  2. –û–∂–∏–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Ü–µ–ª–∏ –ø–æ—Å–ª–µ –∫–Ω–æ–ø–∫–∏ ¬´–ù–æ–≤—ã–π –ø–ª–∞–Ω —Ü–µ–ª–∏¬ª
  3. –û–∂–∏–¥–∞–Ω–∏—è —à–∞–≥–∞ —Ü–µ–ª–∏ (add_step)
  4. –û–∂–∏–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (update_progress)
  5. –û–∂–∏–¥–∞–Ω–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è/—Å–±—Ä–æ—Å–∞ (confirm_*)
  6. –ë—É–¥—É—â–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è: –≥–æ–ª–æ—Å–æ–≤—ã–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∏ —Ç.–¥.

–í—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–∏–Ω –∫–ª–∞—Å—Å PlannerStates ‚Äî —É–¥–æ–±–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å.

–ê–≤—Ç–æ—Ä: Grok –ø–æ —Ç–≤–æ–µ–º—É –¢–ó
–î–∞—Ç–∞: 26 —Ñ–µ–≤—Ä–∞–ª—è 2026
–í–µ—Ä—Å–∏—è: 2.1
"""

from aiogram.fsm.state import State, StatesGroup

class PlannerStates(StatesGroup):
    """
    –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –±–æ—Ç–∞.
    
    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ handlers:
        from states import PlannerStates
        
        await state.set_state(PlannerStates.waiting_for_text)
        if await state.get_state() == PlannerStates.waiting_for_goal.state:
            ...
    """

    # === –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è ===
    waiting_for_text = State()          # –û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è/—Å–æ–±—ã—Ç–∏–π
    waiting_for_goal = State()          # –û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–æ–≤–æ–π —Ü–µ–ª–∏

    # === –°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ü–µ–ª—è–º–∏ ===
    waiting_for_goal_step = State()     # –û–∂–∏–¥–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ —Ü–µ–ª–∏
    waiting_for_goal_progress = State() # –û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ % –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (0‚Äì100)

    # === –°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–æ–ø–∞—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è) ===
    waiting_for_confirm_delete_goal = State()   # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è —Ü–µ–ª–∏
    waiting_for_confirm_reset_stats = State()   # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–±—Ä–æ—Å–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    waiting_for_confirm_restart_bot = State()   # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (–∞–¥–º–∏–Ω)

    # === –°–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–±—É–¥—É—â–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è) ===
    waiting_for_edit_event = State()            # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–æ–±—ã—Ç–∏—è
    waiting_for_edit_goal_deadline = State()    # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–µ–¥–ª–∞–π–Ω–∞ —Ü–µ–ª–∏
    waiting_for_edit_goal_title = State()       # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ü–µ–ª–∏

    # === –ê–¥–º–∏–Ω-—Å–æ—Å—Ç–æ—è–Ω–∏—è ===
    waiting_for_admin_broadcast = State()       # –û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
    waiting_for_admin_command = State()         # –û–∂–∏–¥–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã

    # === –í—Ä–µ–º–µ–Ω–Ω—ã–µ/—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ ===
    waiting_for_voice = State()                 # –ë—É–¥—É—â–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    waiting_for_photo = State()                 # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—à–ª—ë—Ç —Ñ–æ—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ)

    # –ú–µ—Ç–æ–¥ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
    @classmethod
    def list_all(cls) -> list[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫"""
        return [state.state for state in cls.__states__]


# ====================== –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø ======================
"""
–í messages.py:
@router.message(F.text == "üéØ –ù–æ–≤—ã–π –ø–ª–∞–Ω —Ü–µ–ª–∏")
async def new_goal(..., state: FSMContext):
    await state.set_state(PlannerStates.waiting_for_goal)

–í callbacks.py:
elif data.startswith("update_progress_"):
    await state.set_state(PlannerStates.waiting_for_goal_progress)
    await callback.message.edit_text("–í–≤–µ–¥–∏ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å (0‚Äì100):")
"""

logger.info(f"‚úÖ states.py –∑–∞–≥—Ä—É–∂–µ–Ω. –í—Å–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π: {len(PlannerStates.list_all())}")
